<h1 id="spring-quartz-和-spring-task对比">Spring Quartz 和 Spring Task对比</h1>

<!-- TOC -->

<ul>
  <li><a href="#spring-quartz-和-spring-task对比">Spring Quartz 和 Spring Task对比</a>
    <ul>
      <li><a href="#1spring-quartz-和-spring-task执行时间对比">1、Spring Quartz 和 Spring Task执行时间对比</a></li>
      <li><a href="#2spring-quartz-特点">2、Spring Quartz 特点</a></li>
      <li><a href="#3spring-task特点">3、Spring Task特点</a></li>
      <li><a href="#4spring-quartz配置">4、Spring Quartz配置</a></li>
      <li><a href="#5spring-task配置">5、Spring Task配置</a></li>
    </ul>
  </li>
</ul>

<!-- /TOC -->

<h2 id="1spring-quartz-和-spring-task执行时间对比">1、Spring Quartz 和 Spring Task执行时间对比</h2>
<ul>
  <li>Quartz设置同步模式时：一个任务的两次执行的时间间隔是：“执行时间”和“trigger的设定间隔”的<code class="highlighter-rouge">最大值 </code></li>
  <li>Task默认同步模式：一个任务的两次执行的时间间隔是：“执行时间”+“trigger的设定间隔”，即<code class="highlighter-rouge">一个任务完成执行后</code>，才开始trigger计时</li>
</ul>

<h2 id="2spring-quartz-特点">2、Spring Quartz 特点</h2>
<ul>
  <li><code class="highlighter-rouge">默认多线程异步执行 </code></li>
  <li>一个任务在上一次调度未完成执行，下一次调度时间到时，会另起一个线程开始新的调度。在业务繁忙时，一个任务或许会有多个线程在执行，导致数据处理异常。</li>
  <li>单任务同步：配置属性，可以使一个任务的一次调度在未完成时，而不会开启下一次调度</li>
  <li>多个任务同时运行，任务之间没有直接的影响，多任务执行的快慢取决于CPU的性能</li>
  <li>SchedulerFactoryBean不能使用注解来配置？还是我没找到注解的方法？</li>
</ul>

<h2 id="3spring-task特点">3、Spring Task特点</h2>
<ul>
  <li><code class="highlighter-rouge">默认单线程同步执行 </code></li>
  <li>一个任务<code class="highlighter-rouge">执行完</code>上一次之后，才会<code class="highlighter-rouge">执行下一次调度</code></li>
  <li>多任务之间按顺序执行，一个任务执行完成之后才会执行另一个任务</li>
  <li>多任务并行执行<code class="highlighter-rouge">需要设置线程池 </code></li>
  <li>全程可以通过注解配置</li>
</ul>

<h2 id="4spring-quartz配置">4、Spring Quartz配置</h2>
<ul>
  <li><code class="highlighter-rouge">配置Job</code>，job的targetObject可以使用spring注解@Service(value = “findObjectService”)配置的bean</li>
  <li><code class="highlighter-rouge">配置Trigger </code></li>
  <li><code class="highlighter-rouge">配置Scheduler</code>
```xml</li>
</ul>
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
  <bean id="findObjectJob" class="org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean"> 
    <property name="targetObject" ref="findObjectService" /> 
    <property name="targetMethod" value="startJob" /> 
    <property name="concurrent" value="false" />
  </bean> 
  <bean id="findObjectTrigger" class="org.springframework.scheduling.quartz.SimpleTriggerBean">
    <property name="jobDetail" ref="findObjectJob" />
    <property name="repeatInterval" value="1000" />  
    <property name="startDelay" value="5000" />   
  </bean>
  <bean class="org.springframework.scheduling.quartz.SchedulerFactoryBean">
    <property name="triggers">
      <list>
        <ref bean="findObjectTrigger" />
      </list>
    </property>
  </bean>
```

## 5、Spring Task配置
- `执行方法添加@Scheduled注解 `
- `配置线程池`

```Java
@Scheduled(cron = "0/1 * *  * * ? ")
public void startJob() {......}
```
```xml
<beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:task="http://www.springframework.org/schema/task" xsi:schemaLocation="
        http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context  
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/task  
        http://www.springframework.org/schema/task/spring-task-3.1.xsd">
<task:executor id="executor" pool-size="5" />
<task:scheduler id="scheduler" pool-size="5" />
<task:annotation-driven executor="executor" scheduler="scheduler" />
<context:annotation-config />  
<context:component-scan base-package="com.test1,com.test2" />  
```

[原文地址 http://blog.csdn.net/mseeworld/article/details/53331197](http://blog.csdn.net/mseeworld/article/details/53331197)
</beans></beans>
