<h1 id="mysql57-新增修改授权用户">Mysql5.7 新增、修改、授权用户</h1>
<!-- TOC -->

<ul>
  <li><a href="#mysql57-新增修改授权用户">Mysql5.7 新增、修改、授权用户</a>
    <ul>
      <li><a href="#1-前置条件">1. 前置条件</a></li>
      <li><a href="#2-创建用户">2. 创建用户</a></li>
      <li><a href="#3-授权">3. 授权</a></li>
      <li><a href="#4-创建用户同时授权">4. 创建用户同时授权</a></li>
      <li><a href="#5-设置与更改用户密码">5. 设置与更改用户密码</a></li>
      <li><a href="#6-撤销用户权限">6. 撤销用户权限</a></li>
      <li><a href="#7-删除用户">7. 删除用户</a></li>
      <li><a href="#8-查看用户的授权">8. 查看用户的授权</a></li>
    </ul>
  </li>
</ul>

<!-- /TOC -->
<h2 id="1-前置条件">1. 前置条件</h2>
<ul>
  <li>登录 <code class="highlighter-rouge">mysql -uroot -proot -hlocalhost</code></li>
  <li>2.MySQL5.7 mysql.user表没有<code class="highlighter-rouge">password字段改 authentication_string</code></li>
</ul>

<h2 id="2-创建用户">2. 创建用户</h2>

<p>命令:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CREATE USER 'username'@'host' IDENTIFIED BY 'password';
</code></pre></div></div>

<p>例子:</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>CREATE USER 'dog'@'localhost' IDENTIFIED BY '123456';
CREATE USER 'dog2'@'localhost' IDENTIFIED BY '';
</code></pre></div></div>

<p>PS</p>
<ul>
  <li><code class="highlighter-rouge">username</code> - 你将创建的用户名</li>
  <li><code class="highlighter-rouge">host</code> - 指定该用户在哪个主机上可以登陆，此处的”localhost”，是指该用户只能在本地登录，不能在另外一台机器上远程登录，如果想远程登录的话，将”localhost”改为”%”，表示在任何一台电脑上都可以登录;也可以指定某台机器可以远程登录;</li>
  <li><code class="highlighter-rouge">password</code> - 该用户的登陆密码,密码可以为空,如果为空则该用户可以不需要密码登陆服务器。</li>
</ul>

<h2 id="3-授权">3. 授权</h2>

<p>命令</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRANT privileges ON databasename.tablename TO 'username'@'host'
</code></pre></div></div>
<p>PS</p>
<ul>
  <li><code class="highlighter-rouge">privileges</code> - 用户的操作权限,如SELECT , INSERT , UPDATE 等.如果要授予所的权限则使用<code class="highlighter-rouge">ALL</code>.</li>
  <li><code class="highlighter-rouge">databasename</code> - 数据库名</li>
  <li><code class="highlighter-rouge">tablename</code> -表名,如果要授予该用户对所有数据库和表的相应操作权限则可用<em>表示, 如</em>.*.</li>
</ul>

<p>例子</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>GRANT SELECT, INSERT ON mq.* TO 'dog'@'localhost';
</code></pre></div></div>

<h2 id="4-创建用户同时授权">4. 创建用户同时授权</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; grant all privileges on mq.* to test@localhost identified by '1234';
Query OK, 0 rows affected, 1 warning (0.00 sec)
</code></pre></div></div>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; flush privileges;
Query OK, 0 rows affected (0.01 sec)
</code></pre></div></div>
<p>PS</p>
<ul>
  <li>必须执行flush privileges; 否则登录时提示：ERROR 1045 (28000): Access denied for user ‘user’@’localhost’ (using password: YES )</li>
</ul>

<h2 id="5-设置与更改用户密码">5. 设置与更改用户密码</h2>

<p>命令</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SET PASSWORD FOR 'username'@'host' = PASSWORD('newpassword');
</code></pre></div></div>
<p>例子</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>SET PASSWORD FOR 'dog2'@'localhost' = PASSWORD("dog");
</code></pre></div></div>
<h2 id="6-撤销用户权限">6. 撤销用户权限</h2>

<p>命令</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REVOKE privilege ON databasename.tablename FROM 'username'@'host';
</code></pre></div></div>
<p>说明</p>
<ul>
  <li>privilege, databasename, tablename - 同授权部分.</li>
</ul>

<p>例子</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>REVOKE SELECT ON mq.* FROM 'dog2'@'localhost';
</code></pre></div></div>
<p>PS</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>假如你在给用户'dog'@'localhost''授权的时候是这样的(或类似的):
GRANT SELECT ON test.user TO 'dog'@'localhost', 
则在使用
REVOKE SELECT ON *.* FROM 'dog'@'localhost';
命令并不能撤销该用户对test数据库中user表的SELECT 操作.

相反,如果授权使用的是
GRANT SELECT ON *.* TO 'dog'@'localhost';
则
REVOKE SELECT ON test.user FROM 'dog'@'localhost';
命令也不能撤销该用户对test数据库中user表的Select 权限.

具体信息可以用命令SHOW GRANTS FOR 'dog'@'localhost'; 查看.
</code></pre></div></div>

<h2 id="7-删除用户">7. 删除用户</h2>
<p>命令</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>DROP USER 'username'@'host';
</code></pre></div></div>
<h2 id="8-查看用户的授权">8. 查看用户的授权</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mysql&gt; show grants for dog@localhost;
+---------------------------------------------+
| Grants for dog@localhost |
+---------------------------------------------+
| GRANT USAGE ON *.* TO 'dog'@'localhost' |
| GRANT INSERT ON `mq`.* TO 'dog'@'localhost' |
+---------------------------------------------+
2 rows in set (0.00 sec)
</code></pre></div></div>
